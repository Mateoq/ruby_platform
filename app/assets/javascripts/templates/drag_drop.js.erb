prTemplates.directive('dragDrop', ['dragNDropService', function (dragNDropService) {
	return {
		templateUrl: 'drag_drop.html',
		restrict: 'E',
		scope: { options: '=options' },
		link: function postLink(scope, element, attrs) {
			scope.options.templateClass = 'drag-drop';

			if (angular.isDefined(scope.$root.game)) {
				scope.$root.game = null;
			}

			scope.$root.game = new Phaser.Game(scope.options.activity.width, scope.options.activity.height, Phaser.CANVAS, scope.options.activityName, null, true);

			scope.options.activity.atlasPath = scope.$root.resources + scope.options.activity.atlasMap;

			dragNDropService(scope.options.activity, scope.$root.game);
		}
	};
}]);