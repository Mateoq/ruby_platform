prTemplates.directive('graphicTable', ['$sce', '$window', '$document', '$timeout', 'graphicService', function ($sce, $window, $document, $timeout, graphicService) {
	return {
		templateUrl: 'graphic_table.html',
		restrict: 'E',
		scope: {
			options: '=options'
		},
		link: function (scope, element, attrs) {
			scope.options.templateClass = 'graphic-table';
			
			if (!scope.options.hasOwnProperty('method')) return;

			scope.options.canvasId = graphicService.methods[scope.options.method];

			scope.$root.game = new Phaser.Game(400, 400, Phaser.CANVAS, scope.options.canvasId, null, true);

			scope.options.graphicData.atlasPath = scope.$root.resources + scope.options.graphicData.atlasMap;
			scope.options.graphicData.method = scope.options.method;
			graphicService(scope.options.graphicData, scope.$root.game);
		}
	};
}]);